function Out = WaveletTrafoF(I,typeflag,wavelettype)
% Input:     - I: A 2D image
%            - typeflag: Struct of logicals to permit extracting features 
%              based on desired characteristics:
%                   + typeflag.global: all features 
%                   + typeflag.transform: all features 
%                   + typeflag.corr: only features based on correlation
%                   + typeflag.entropy: only features based on entropy
%                   + typeflag.moments: only features based on moments
%              default: all features are being extracted
%              For more information see README.txt
%            - wavelettype: Struct of logicals to choose which type of
%              wavelet should be employed:
%                   + wavelettype.haar: Haar (or Daubechies 1) wavelet
%                   + wavelettype.coif: Coifets 1 wavelet
%                   + wavelettype.dmey: Discrete Meyer wavelet
%              default: all types of wavelets are being used
%
%
% Output:    - Out: A (1x4759) vector containing 4759 metrics calculated 
%                   from the wavelet transform
%
% Implemented wavelets: Daubechies 1 (aka Haar), Coiflets 1, Discrete Meyer
%
% ************************************************************************
% Modified for MRI feature extraction by the Department of Diagnostic 
% and Interventional Radiology, University Hospital of Tuebingen, Germany 
% and the Institute of Signal Processing and System Theory University of 
% Stuttgart, Germany. Last modified: February 2017
%
% This implementation is part of ImFEATbox, a toolbox for image feature
% extraction and analysis. Available online at:
% https://github.com/annikaliebgott/ImFEATbox
%
% Contact: annika.liebgott@iss.uni-stuttgart.de
% ************************************************************************

if ~exist('typeflag','var')
   typeflag.global = true; 
   typeflag.transform = true;
   typeflag.corr = true;
   typeflag.entropy = true;
   typeflag.moments = true;
end    

if ~exist('wavelettype','var')
    wavelettype.haar = true;
    wavelettype.coif = true;
    wavelettype.dmey = true;
end

if(~isreal(I))
%     warning('WaveletTrafoF(): Only processing of real input data');
    I = real(I);
end

%% Wavelet transfrom

% 2D discrete wavelet analysis
if wavelettype.haar
    [C_L1,S_L1] = wavedec2(I,1,'haar');
    [C_L2,S_L2] = wavedec2(I,2,'haar');
    [C_L3,S_L3] = wavedec2(I,3,'haar');
    [C_L4,S_L4] = wavedec2(I,4,'haar');
end
if wavelettype.coif
    [C_L5,S_L5] = wavedec2(I,1,'coif1');
    [C_L6,S_L6] = wavedec2(I,2,'coif1');
    [C_L7,S_L7] = wavedec2(I,3,'coif1');
end
if wavelettype.dmey
    [C_L8,S_L8] = wavedec2(I,1,'dmey');
    [C_L9,S_L9] = wavedec2(I,2,'dmey');
    [C_L10,S_L10] = wavedec2(I,3,'dmey');
end

% 2D approximation coefficients
if wavelettype.haar
    A1 = appcoef2(C_L1,S_L1,'haar');
    A2 = appcoef2(C_L2,S_L2,'haar');
    A3 = appcoef2(C_L3,S_L3,'haar');
    A4 = appcoef2(C_L4,S_L4,'haar');
end
if wavelettype.coif
    A5 = appcoef2(C_L5,S_L5,'coif1');
    A6 = appcoef2(C_L6,S_L6,'coif1');
    A7 = appcoef2(C_L7,S_L7,'coif1');
end
if wavelettype.dmey
    A8 = appcoef2(C_L8,S_L8,'dmey');
    A9 = appcoef2(C_L9,S_L9,'dmey');
    A10 = appcoef2(C_L10,S_L10,'dmey');
end

% 2D detail coefficents with 2 different posssible Levels

% Haar or Daubechis db1 wavelets
if wavelettype.haar
    [H11,V11,D11] = detcoef2('all',C_L1,S_L1,1);
    
    [H21,V21,D21] = detcoef2('all',C_L2,S_L2,1);
    [H22,V22,D22] = detcoef2('all',C_L2,S_L2,2);
    
    [H31,V31,D31] = detcoef2('all',C_L3,S_L3,1);
    [H32,V32,D32] = detcoef2('all',C_L3,S_L3,2);
    [H33,V33,D33] = detcoef2('all',C_L3,S_L3,3);
    
    [H41,V41,D41] = detcoef2('all',C_L4,S_L4,1);
    [H42,V42,D42] = detcoef2('all',C_L4,S_L4,2);
    [H43,V43,D43] = detcoef2('all',C_L4,S_L4,3);
    [H44,V44,D44] = detcoef2('all',C_L4,S_L4,4);
end

% Coiflets wavelets
if wavelettype.coif
    [H51,V51,D51] = detcoef2('all',C_L5,S_L5,1);
    
    [H61,V61,D61] = detcoef2('all',C_L6,S_L6,1);
    [H62,V62,D62] = detcoef2('all',C_L6,S_L6,2);
    
    [H71,V71,D71] = detcoef2('all',C_L7,S_L7,1);
    [H72,V72,D72] = detcoef2('all',C_L7,S_L7,2);
    [H73,V73,D73] = detcoef2('all',C_L7,S_L7,3);
end

% Discrete Meyer wavelets
if wavelettype.dmey
    [H81,V81,D81] = detcoef2('all',C_L8,S_L8,1);
    
    [H91,V91,D91] = detcoef2('all',C_L9,S_L9,1);
    [H92,V92,D92] = detcoef2('all',C_L9,S_L9,2);
    
    [H101,V101,D101] = detcoef2('all',C_L10,S_L10,1);
    [H102,V102,D102] = detcoef2('all',C_L10,S_L10,2);
    [H103,V103,D103] = detcoef2('all',C_L10,S_L10,3);
end

%% calculate energy for 2D wavelet decomposition
% Ea is the percentage of energy corresponding to the approximation.
% Vectors Eh, Ev and Ed contain the percentages of energy corresponding to
% the horizontal, vertical, and diagonal details
if wavelettype.haar
    [Ea1,Eh1,Ev1,Ed1] = wenergy2(C_L1,S_L1);
    [Ea2,Eh2,Ev2,Ed2] = wenergy2(C_L2,S_L2);
    [Ea3,Eh3,Ev3,Ed3] = wenergy2(C_L3,S_L3);
    [Ea4,Eh4,Ev4,Ed4] = wenergy2(C_L4,S_L4);
end
if wavelettype.coif
    [Ea5,Eh5,Ev5,Ed5] = wenergy2(C_L5,S_L5);
    [Ea6,Eh6,Ev6,Ed6] = wenergy2(C_L6,S_L6);
    [Ea7,Eh7,Ev7,Ed7] = wenergy2(C_L7,S_L7);
end
if wavelettype.dmey
    [Ea8,Eh8,Ev8,Ed8] = wenergy2(C_L8,S_L8);
    [Ea9,Eh9,Ev9,Ed9] = wenergy2(C_L9,S_L9);
    [Ea10,Eh10,Ev10,Ed10] = wenergy2(C_L10,S_L10);
end

%% approximation quality metrics

if wavelettype.haar
    [C_h,S_h] = wavedec2(I, 3, 'haar');
    XAPP_h = waverec2(C_h,S_h,'haar');
    [PSNR_h,MSE_h,MAXERR_h,L2RAT_h] = measerr(I, XAPP_h);
end

if wavelettype.coif
    [C_c,S_c] = wavedec2(I, 3, 'coif1');
    XAPP_c = waverec2(C_c,S_c,'coif1');
    [PSNR_c,MSE_c,MAXERR_c,L2RAT_c] = measerr(I, XAPP_c);
end

if wavelettype.dmey
    [C_d,S_d] = wavedec2(I, 3, 'dmey');
    XAPP_d = waverec2(C_d,S_d,'dmey');
    [PSNR_d,MSE_d,MAXERR_d,L2RAT_d] = measerr(I, XAPP_d);
end

if wavelettype.haar
    Q_h = [PSNR_h; MSE_h; MAXERR_h; L2RAT_h];
end
if wavelettype.coif
    Q_c = [PSNR_c; MSE_c; MAXERR_c; L2RAT_c];
end
if wavelettype.dmey
    Q_d = [PSNR_d; MSE_d; MAXERR_d; L2RAT_d];
end

if wavelettype.haar && wavelettype.coif && wavelettype.dmey
    MAXERR = [MAXERR_h MAXERR_c MAXERR_d];
    L2RAT = [L2RAT_h L2RAT_c L2RAT_d];
    MSE = [MSE_h MSE_c MSE_d];
    PSNR = [PSNR_h PSNR_c PSNR_d];
end


%% Wavelet packet analysis

% Wavelet packet decomposition 2-D
if wavelettype.haar
    T_shan_haar = wpdec2(I,3,'haar', 'shannon');
    T_log_haar = wpdec2(I,3,'haar', 'log energy');
end
if wavelettype.coif
    T_shan_coif = wpdec2(I,3,'coif1', 'shannon');
    T_log_coif = wpdec2(I,3,'coif1', 'log energy');
end
if wavelettype.dmey
    T_shan_dmey = wpdec2(I,3,'dmey', 'shannon');
    T_log_dmey = wpdec2(I,3,'dmey', 'log energy');
end

% Wavelet packet coefficients
if wavelettype.haar
    X1 = wpcoef(T_shan_haar);
    X2 = wpcoef(T_log_haar);
end
if wavelettype.coif
    X3 = wpcoef(T_shan_coif);
    X4 = wpcoef(T_log_coif);
end
if wavelettype.dmey
    X5 = wpcoef(T_shan_dmey);
    X6 = wpcoef(T_log_dmey);
end

% Best level tree wavelet packet analysis
if wavelettype.haar
    T_best1 = bestlevt(T_shan_haar);
    T_best2 = bestlevt(T_log_haar);
end
if wavelettype.coif
    T_best3 = bestlevt(T_shan_coif);
    T_best4 = bestlevt(T_log_coif);
end
if wavelettype.dmey
    T_best5 = bestlevt(T_shan_dmey);
    T_best6 = bestlevt(T_log_dmey);
end

% tree nodes
if wavelettype.haar
    linearIndicies1 = allnodes(T_best1);
    linearIndicies2 = allnodes(T_best2);
end
if wavelettype.coif
    linearIndicies3 = allnodes(T_best3);
    linearIndicies4 = allnodes(T_best4);
end
if wavelettype.dmey
    linearIndicies5 = allnodes(T_best5);
    linearIndicies6 = allnodes(T_best6);
end


%% extract features

if typeflag.global || typeflag.transform || typeflag.entropy
    % Entropy (wavelet packet)
    H1 = wentropy(I, 'shannon');
    H2 = wentropy(I, 'log energy');
end

% sum tree nodes
if wavelettype.haar
    treenode_sum1 = size(linearIndicies1, 1);
    treenode_sum2 = size(linearIndicies2, 1);
end
if wavelettype.coif
    treenode_sum3 = size(linearIndicies3, 1);
    treenode_sum4 = size(linearIndicies4, 1);
end
if wavelettype.dmey
    treenode_sum5 = size(linearIndicies5, 1);
    treenode_sum6 = size(linearIndicies6, 1);
end

% wavelet packat coefficients from begin, middle and end of matrices
if wavelettype.haar
    X1_b = X1(round(0.2*size(X1,1)),round(0.2*size(X1,2)));
    X1_m = X1(round(0.5*size(X1,1)),round(0.5*size(X1,2)));
    X1_e = X1(round(0.8*size(X1,1)),round(0.8*size(X1,2)));
    X2_b = X2(round(0.2*size(X2,1)),round(0.2*size(X2,2)));
    X2_m = X2(round(0.5*size(X2,1)),round(0.5*size(X2,2)));
    X2_e = X2(round(0.8*size(X2,1)),round(0.8*size(X2,2)));
end
if wavelettype.coif
    X3_b = X3(round(0.2*size(X3,1)),round(0.2*size(X3,2)));
    X3_m = X3(round(0.5*size(X3,1)),round(0.5*size(X3,2)));
    X3_e = X3(round(0.8*size(X3,1)),round(0.8*size(X3,2)));
    X4_b = X4(round(0.2*size(X4,1)),round(0.2*size(X4,2)));
    X4_m = X4(round(0.5*size(X4,1)),round(0.5*size(X4,2)));
    X4_e = X4(round(0.8*size(X4,1)),round(0.8*size(X4,2)));
end

if wavelettype.coif
    X5_b = X5(round(0.2*size(X5,1)),round(0.2*size(X5,2)));
    X5_m = X5(round(0.5*size(X5,1)),round(0.5*size(X5,2)));
    X5_e = X5(round(0.8*size(X5,1)),round(0.8*size(X5,2)));
    X6_b = X6(round(0.2*size(X6,1)),round(0.2*size(X6,2)));
    X6_m = X6(round(0.5*size(X6,1)),round(0.5*size(X6,2)));
    X6_e = X6(round(0.8*size(X6,1)),round(0.8*size(X6,2)));
end


if typeflag.global || typeflag.transform || typeflag.moments
    % features from 2D detail coefficents moments (2nd and 4th)
    
    % mean and standard derivation of the moments
    if wavelettype.haar
        m_2_H11 = mean2(moment(H11,2));
        m_2_V11 = mean2(moment(V11,2));
        m_2_D11 = mean2(moment(D11,2));
        
        m_2_H21 = mean2(moment(H21,2));
        m_2_V21 = mean2(moment(V21,2));
        m_2_D21 = mean2(moment(D21,2));
        m_2_H22 = mean2(moment(H22,2));
        m_2_V22 = mean2(moment(V22,2));
        m_2_D22 = mean2(moment(D22,2));
        
        m_2_H31 = mean2(moment(H31,2));
        m_2_V31 = mean2(moment(V31,2));
        m_2_D31 = mean2(moment(D31,2));
        m_2_H32 = mean2(moment(H32,2));
        m_2_V32 = mean2(moment(V32,2));
        m_2_D32 = mean2(moment(D32,2));
        m_2_H33 = mean2(moment(H33,2));
        m_2_V33 = mean2(moment(V33,2));
        m_2_D33 = mean2(moment(D33,2));
        
        m_2_H41 = mean2(moment(H41,2));
        m_2_V41 = mean2(moment(V41,2));
        m_2_D41 = mean2(moment(D41,2));
        m_2_H42 = mean2(moment(H42,2));
        m_2_V42 = mean2(moment(V42,2));
        m_2_D42 = mean2(moment(D42,2));
        m_2_H43 = mean2(moment(H43,2));
        m_2_V43 = mean2(moment(V43,2));
        m_2_D43 = mean2(moment(D43,2));
        m_2_H44 = mean2(moment(H44,2));
        m_2_V44 = mean2(moment(V44,2));
        m_2_D44 = mean2(moment(D44,2));
        
        m_4_H11 = mean2(moment(H11,4));
        m_4_V11 = mean2(moment(V11,4));
        m_4_D11 = mean2(moment(D11,4));
        
        m_4_H21 = mean2( moment(H21,4));
        m_4_V21 = mean2(moment(V21,4));
        m_4_D21 = mean2(moment(D21,4));
        m_4_H22 = mean2(moment(H22,4));
        m_4_V22 = mean2(moment(V22,4));
        m_4_D22 = mean2(moment(D22,4));
        
        m_4_H31 = mean2(moment(H31,4));
        m_4_V31 = mean2(moment(V31,4));
        m_4_D31 = mean2(moment(D31,4));
        m_4_H32 = mean2(moment(H32,4));
        m_4_V32 = mean2(moment(V32,4));
        m_4_D32 = mean2(moment(D32,4));
        m_4_H33 = mean2(moment(H33,4));
        m_4_V33 = mean2(moment(V33,4));
        m_4_D33 = mean2(moment(D33,4));
        
        m_4_H41 = mean2(moment(H41,4));
        m_4_V41 = mean2(moment(V41,4));
        m_4_D41 = mean2(moment(D41,4));
        m_4_H42 = mean2(moment(H42,4));
        m_4_V42 = mean2(moment(V42,4));
        m_4_D42 = mean2(moment(D42,4));
        m_4_H43 = mean2(moment(H43,4));
        m_4_V43 = mean2(moment(V43,4));
        m_4_D43 = mean2(moment(D43,4));
        m_4_H44 = mean2(moment(H44,4));
        m_4_V44 = mean2(moment(V44,4));
        m_4_D44 = mean2(moment(D44,4));
        
        ms_2_H11 = std2(moment(H11,2));
        ms_2_V11 = std2(moment(V11,2));
        ms_2_D11 = std2(moment(D11,2));
        
        ms_2_H21 = std2(moment(H21,2));
        ms_2_V21 = std2(moment(V21,2));
        ms_2_D21 = std2(moment(D21,2));
        ms_2_H22 = std2(moment(H22,2));
        ms_2_V22 = std2(moment(V22,2));
        ms_2_D22 = std2(moment(D22,2));
        
        ms_2_H31 = std2(moment(H31,2));
        ms_2_V31 = std2(moment(V31,2));
        ms_2_D31 = std2(moment(D31,2));
        ms_2_H32 = std2(moment(H32,2));
        ms_2_V32 = std2(moment(V32,2));
        ms_2_D32 = std2(moment(D32,2));
        ms_2_H33 = std2(moment(H33,2));
        ms_2_V33 = std2(moment(V33,2));
        ms_2_D33 = std2(moment(D33,2));
        
        ms_2_H41 = std2(moment(H41,2));
        ms_2_V41 = std2(moment(V41,2));
        ms_2_D41 = std2(moment(D41,2));
        ms_2_H42 = std2(moment(H42,2));
        ms_2_V42 = std2(moment(V42,2));
        ms_2_D42 = std2(moment(D42,2));
        ms_2_H43 = std2(moment(H43,2));
        ms_2_V43 = std2(moment(V43,2));
        ms_2_D43 = std2(moment(D43,2));
        ms_2_H44 = std2(moment(H44,2));
        ms_2_V44 = std2(moment(V44,2));
        ms_2_D44 = std2(moment(D44,2));
        
        ms_4_H11 = std2(moment(H11,4));
        ms_4_V11 = std2(moment(V11,4));
        ms_4_D11 = std2(moment(D11,4));
        
        ms_4_H21 = std2( moment(H21,4));
        ms_4_V21 = std2(moment(V21,4));
        ms_4_D21 = std2(moment(D21,4));
        ms_4_H22 = std2(moment(H22,4));
        ms_4_V22 = std2(moment(V22,4));
        ms_4_D22 = std2(moment(D22,4));
        
        ms_4_H31 = std2(moment(H31,4));
        ms_4_V31 = std2(moment(V31,4));
        ms_4_D31 = std2(moment(D31,4));
        ms_4_H32 = std2(moment(H32,4));
        ms_4_V32 = std2(moment(V32,4));
        ms_4_D32 = std2(moment(D32,4));
        ms_4_H33 = std2(moment(H33,4));
        ms_4_V33 = std2(moment(V33,4));
        ms_4_D33 = std2(moment(D33,4));
        
        ms_4_H41 = std2(moment(H41,4));
        ms_4_V41 = std2(moment(V41,4));
        ms_4_D41 = std2(moment(D41,4));
        ms_4_H42 = std2(moment(H42,4));
        ms_4_V42 = std2(moment(V42,4));
        ms_4_D42 = std2(moment(D42,4));
        ms_4_H43 = std2(moment(H43,4));
        ms_4_V43 = std2(moment(V43,4));
        ms_4_D43 = std2(moment(D43,4));
        ms_4_H44 = std2(moment(H44,4));
        ms_4_V44 = std2(moment(V44,4));
        ms_4_D44 = std2(moment(D44,4));
        
        % mean and std of 2D approximation coefficients
        m_2_A1 = mean2(moment(A1,2));
        m_2_A2 = mean2(moment(A2,2));
        m_2_A3 = mean2(moment(A3,2));
        m_2_A4 = mean2(moment(A4,2));
        
        m_4_A1 = mean2(moment(A1,4));
        m_4_A2 = mean2(moment(A2,4));
        m_4_A3 = mean2(moment(A3,4));
        m_4_A4 = mean2(moment(A4,4));
        
        ms_2_A1 = std2(moment(A1,2));
        ms_2_A2 = std2(moment(A2,2));
        ms_2_A3 = std2(moment(A3,2));
        ms_2_A4 = std2(moment(A4,2));
        
        ms_4_A1 = std2(moment(A1,4));
        ms_4_A2 = std2(moment(A2,4));
        ms_4_A3 = std2(moment(A3,4));
        ms_4_A4 = std2(moment(A4,4));
    end
    
    if wavelettype.coif
        m_2_H51 = mean2(moment(H51,2));
        m_2_V51 = mean2(moment(V51,2));
        m_2_D51 = mean2(moment(D51,2));
        
        m_2_H61 = mean2(moment(H61,2));
        m_2_V61 = mean2( moment(V61,2));
        m_2_D61 = mean2(moment(D61,2));
        m_2_H62 = mean2(moment(H62,2));
        m_2_V62 = mean2(moment(V62,2));
        m_2_D62 = mean2(moment(D62,2));
        
        m_2_H71 = mean2(moment(H71,2));
        m_2_V71 = mean2(moment(V71,2));
        m_2_D71 = mean2(moment(D71,2));
        m_2_H72 = mean2(moment(H72,2));
        m_2_V72 = mean2(moment(V72,2));
        m_2_D72 = mean2(moment(D72,2));
        m_2_H73 = mean2(moment(H73,2));
        m_2_V73 = mean2(moment(V73,2));
        m_2_D73 = mean2(moment(D73,2));
        
        m_4_H51 = mean2(moment(H51,4));
        m_4_V51 = mean2(moment(V51,4));
        m_4_D51 = mean2(moment(D51,4));
        
        m_4_H61 = mean2(moment(H61,4));
        m_4_V61 = mean2(moment(V61,4));
        m_4_D61 = mean2(moment(D61,4));
        
        m_4_H62 = mean2(moment(H62,4));
        m_4_V62 = mean2(moment(V62,4));
        m_4_D62 = mean2(moment(D62,4));
        
        m_4_H71 = mean2(moment(H71,4));
        m_4_V71 = mean2(moment(V71,4));
        m_4_D71 = mean2(moment(D71,4));
        m_4_H72 = mean2(moment(H72,4));
        m_4_V72 = mean2(moment(V72,4));
        m_4_D72 = mean2(moment(D72,4));
        m_4_H73 = mean2(moment(H73,4));
        m_4_V73 = mean2(moment(V73,4));
        m_4_D73 = mean2(moment(D73,4));
        
        ms_2_H51 = std2(moment(H51,2));
        ms_2_V51 = std2(moment(V51,2));
        ms_2_D51 = std2(moment(D51,2));
        
        ms_2_H61 = std2(moment(H61,2));
        ms_2_V61 = std2( moment(V61,2));
        ms_2_D61 = std2(moment(D61,2));
        ms_2_H62 = std2(moment(H62,2));
        ms_2_V62 = std2(moment(V62,2));
        ms_2_D62 = std2(moment(D62,2));
        
        ms_2_H71 = std2(moment(H71,2));
        ms_2_V71 = std2(moment(V71,2));
        ms_2_D71 = std2(moment(D71,2));
        ms_2_H72 = std2(moment(H72,2));
        ms_2_V72 = std2(moment(V72,2));
        ms_2_D72 = std2(moment(D72,2));
        ms_2_H73 = std2(moment(H73,2));
        ms_2_V73 = std2(moment(V73,2));
        ms_2_D73 = std2(moment(D73,2));
        
        ms_4_H51 = std2(moment(H51,4));
        ms_4_V51 = std2(moment(V51,4));
        ms_4_D51 = std2(moment(D51,4));
        
        ms_4_H61 = std2(moment(H61,4));
        ms_4_V61 = std2(moment(V61,4));
        ms_4_D61 = std2(moment(D61,4));
        ms_4_H62 = std2(moment(H62,4));
        ms_4_V62 = std2(moment(V62,4));
        ms_4_D62 = std2(moment(D62,4));
        
        ms_4_H71 = std2(moment(H71,4));
        ms_4_V71 = std2(moment(V71,4));
        ms_4_D71 = std2(moment(D71,4));
        ms_4_H72 = std2(moment(H72,4));
        ms_4_V72 = std2(moment(V72,4));
        ms_4_D72 = std2(moment(D72,4));
        ms_4_H73 = std2(moment(H73,4));
        ms_4_V73 = std2(moment(V73,4));
        ms_4_D73 = std2(moment(D73,4));
        
        % mean and std of moments of 2D approximation coefficients
        m_2_A5 = mean2(moment(A5,2));
        m_2_A6 = mean2(moment(A6,2));
        m_2_A7 = mean2(moment(A7,2));
        
        m_4_A5 = mean2(moment(A5,4));
        m_4_A6 = mean2(moment(A6,4));
        m_4_A7 = mean2(moment(A7,4));
        
        ms_2_A5 = std2(moment(A5,2));
        ms_2_A6 = std2(moment(A6,2));
        ms_2_A7 = std2(moment(A7,2));
        
        ms_4_A5 = std2(moment(A5,4));
        ms_4_A6 = std2(moment(A6,4));
        ms_4_A7 = std2(moment(A7,4));
    end
    
    if wavelettype.dmey
        m_2_H81 = mean2(moment(H81,2));
        m_2_V81 = mean2(moment(V81,2));
        m_2_D81 = mean2(moment(D81,2));
        
        m_2_H91 = mean2(moment(H91,2));
        m_2_V91 = mean2(moment(V91,2));
        m_2_D91 = mean2(moment(D91,2));
        m_2_H92 = mean2(moment(H92,2));
        m_2_V92 = mean2(moment(V92,2));
        m_2_D92 = mean2(moment(D92,2));
        
        m_2_H101 = mean2(moment(H101,2));
        m_2_V101 = mean2(moment(V101,2));
        m_2_D101 = mean2(moment(D101,2));
        m_2_H102 = mean2(moment(H102,2));
        m_2_V102 = mean2(moment(V102,2));
        m_2_D102 = mean2(moment(D102,2));
        m_2_H103 = mean2(moment(H103,2));
        m_2_V103 = mean2(moment(V103,2));
        m_2_D103 = mean2(moment(D103,2));
        
        m_4_H81 = mean2(moment(H81,4));
        m_4_V81 = mean2(moment(V81,4));
        m_4_D81 = mean2(moment(D81,4));
        
        m_4_H91 = mean2(moment(H91,4));
        m_4_V91 = mean2(moment(V91,4));
        m_4_D91 = mean2(moment(D91,4));
        m_4_H92 = mean2(moment(H92,4));
        m_4_V92 = mean2(moment(V92,4));
        m_4_D92 = mean2(moment(D92,4));
        
        m_4_H101 = mean2(moment(H101,4));
        m_4_V101 = mean2(moment(V101,4));
        m_4_D101 = mean2(moment(D101,4));
        m_4_H102 = mean2(moment(H102,4));
        m_4_V102 = mean2(moment(V102,4));
        m_4_D102 = mean2(moment(D102,4));
        m_4_H103 = mean2(moment(H103,4));
        m_4_V103 = mean2(moment(V103,4));
        m_4_D103 = mean2(moment(D103,4));
        
        ms_2_H81 = std2(moment(H81,2));
        ms_2_V81 = std2(moment(V81,2));
        ms_2_D81 = std2(moment(D81,2));
        
        ms_2_H91 = std2(moment(H91,2));
        ms_2_V91 = std2(moment(V91,2));
        ms_2_D91 = std2(moment(D91,2));
        ms_2_H92 = std2(moment(H92,2));
        ms_2_V92 = std2(moment(V92,2));
        ms_2_D92 = std2(moment(D92,2));
        
        ms_2_H101 = std2(moment(H101,2));
        ms_2_V101 = std2(moment(V101,2));
        ms_2_D101 = std2(moment(D101,2));
        ms_2_H102 = std2(moment(H102,2));
        ms_2_V102 = std2(moment(V102,2));
        ms_2_D102 = std2(moment(D102,2));
        ms_2_H103 = std2(moment(H103,2));
        ms_2_V103 = std2(moment(V103,2));
        ms_2_D103 = std2(moment(D103,2));
        
        ms_4_H81 = std2(moment(H81,4));
        ms_4_V81 = std2(moment(V81,4));
        ms_4_D81 = std2(moment(D81,4));
        
        ms_4_H91 = std2(moment(H91,4));
        ms_4_V91 = std2(moment(V91,4));
        ms_4_D91 = std2(moment(D91,4));
        ms_4_H92 = std2(moment(H92,4));
        ms_4_V92 = std2(moment(V92,4));
        ms_4_D92 = std2(moment(D92,4));
        
        ms_4_H101 = std2(moment(H101,4));
        ms_4_V101 = std2(moment(V101,4));
        ms_4_D101 = std2(moment(D101,4));
        ms_4_H102 = std2(moment(H102,4));
        ms_4_V102 = std2(moment(V102,4));
        ms_4_D102 = std2(moment(D102,4));
        ms_4_H103 = std2(moment(H103,4));
        ms_4_V103 = std2(moment(V103,4));
        ms_4_D103 = std2(moment(D103,4));
        
        % mean and std of moments of 2D approximation coefficients
        m_2_A8 = mean2(moment(A8,2));
        m_2_A9 = mean2(moment(A9,2));
        m_2_A10 = mean2(moment(A10,2));
        
        m_4_A8 = mean2(moment(A8,4));
        m_4_A9 = mean2(moment(A9,4));
        m_4_A10 = mean2(moment(A10,4));
        
        ms_2_A8 = std2(moment(A8,2));
        ms_2_A9 = std2(moment(A9,2));
        ms_2_A10 = std2(moment(A10,2));
        
        ms_4_A8 = std2(moment(A8,4));
        ms_4_A9 = std2(moment(A9,4));
        ms_4_A10 = std2(moment(A10,4));
    end
    
end

if typeflag.global || typeflag.transform || typeflag.corr
    % correlation between different 2D detail coefficients and 2D detail
    % coefficients and 2D approximation coefficents
    if wavelettype.haar
        rho_H11V11 = corr2(H11,V11);
        rho_H11D11 = corr2(H11,D11);
        rho_V11D11 = corr2(V11,D11);
        rho_H11A1 = corr2(H11,A1);
        rho_V11A1 = corr2(V11,A1);
        rho_D11A1 = corr2(D11,A1);
        
        rho_H21V21 = corr2(H21,V21);
        rho_H21D21 = corr2(H21,D21);
        rho_V21D21 = corr2(V21,D21);
        rho_H21A1 = corr2(H21,A1);
        rho_V21A1 = corr2(V21,A1);
        rho_D21A1 = corr2(D21,A1);
        
        rho_H22V22 = corr2(H22,V22);
        rho_H22D22 = corr2(H22,D22);
        rho_V22D22 = corr2(V22,D22);
        rho_H22A2 = corr2(H22,A2);
        rho_V22A2 = corr2(V22,A2);
        rho_D22A2 = corr2(D22,A2);
        
        rho_H31V31 = corr2(H31,V31);
        rho_H31D31 = corr2(H31,D31);
        rho_V31D31 = corr2(V31,D31);
        rho_H31A1 = corr2(H31,A1);
        rho_V31A1 = corr2(V31,A1);
        rho_D31A1 = corr2(D31,A1);
        
        rho_H32V32 = corr2(H32,V32);
        rho_H32D32 = corr2(H32,D32);
        rho_V32D32 = corr2(V32,D32);
        rho_H32A2 = corr2(H32,A2);
        rho_V32A2 = corr2(V32,A2);
        rho_D32A2 = corr2(D32,A2);
        
        rho_H33V33 = corr2(H33,V33);
        rho_H33D33 = corr2(H33,D33);
        rho_V33D33 = corr2(V33,D33);
        rho_H33A3 = corr2(H33,A3);
        rho_V33A3 = corr2(V33,A3);
        rho_D33A3 = corr2(D33,A3);
        
        rho_H41V41 = corr2(H41,V41);
        rho_H41D41 = corr2(H41,D41);
        rho_V41D41 = corr2(V41,D41);
        rho_H41A1 = corr2(H41,A1);
        rho_V41A1 = corr2(V41,A1);
        rho_D41A1 = corr2(D41,A1);
        
        rho_H42V42 = corr2(H42,V42);
        rho_H42D42 = corr2(H42,D42);
        rho_V42D42 = corr2(V42,D42);
        rho_H42A2 = corr2(H42,A2);
        rho_V42A2 = corr2(V42,A2);
        rho_D42A2 = corr2(D42,A2);
        
        rho_H43V43 = corr2(H43,V43);
        rho_H43D43 = corr2(H43,D43);
        rho_V43D43 = corr2(V43,D43);
        rho_H43A3 = corr2(H43,A3);
        rho_V43A3 = corr2(V43,A3);
        rho_D43A3 = corr2(D43,A3);
        
        rho_H44V44 = corr2(H44,V44);
        rho_H44D44 = corr2(H44,D44);
        rho_V44D44 = corr2(V44,D44);
        rho_H44A4 = corr2(H44,A4);
        rho_V44A4 = corr2(V44,A4);
        rho_D44A4 = corr2(D44,A4);
    end
    
    if wavelettype.coif
        rho_H51V51 = corr2(H51,V51);
        rho_H51D51 = corr2(H51,D51);
        rho_V51D51 = corr2(V51,D51);
        rho_H51A5 = corr2(H51,A5);
        rho_V51A5 = corr2(V51,A5);
        rho_D51A5 = corr2(D51,A5);
        
        rho_H61V61 = corr2(H61,V61);
        rho_H61D61 = corr2(H61,D61);
        rho_V61D61 = corr2(V61,D61);
        rho_H61A5 = corr2(H61,A5);
        rho_V61A5 = corr2(V61,A5);
        rho_D61A5 = corr2(D61,A5);
        
        rho_H62V62 = corr2(H62,V62);
        rho_H62D62 = corr2(H62,D62);
        rho_V62D62 = corr2(V62,D62);
        rho_H62A6 = corr2(H62,A6);
        rho_V62A6 = corr2(V62,A6);
        rho_D62A6 = corr2(D62,A6);
        
        rho_H71V71 = corr2(H71,V71);
        rho_H71D71 = corr2(H71,D71);
        rho_V71D71 = corr2(V71,D71);
        rho_H71A5 = corr2(H71,A5);
        rho_V71A5 = corr2(V71,A5);
        rho_D71A5 = corr2(D71,A5);
        
        rho_H72V72 = corr2(H72,V72);
        rho_H72D72 = corr2(H72,D72);
        rho_V72D72 = corr2(V72,D72);
        rho_H72A6 = corr2(H72,A6);
        rho_V72A6 = corr2(V72,A6);
        rho_D72A6 = corr2(D72,A6);
        
        rho_H73V73 = corr2(H73,V73);
        rho_H73D73 = corr2(H73,D73);
        rho_V73D73 = corr2(V73,D73);
        rho_H73A7 = corr2(H73,A7);
        rho_V73A7 = corr2(V73,A7);
        rho_D73A7 = corr2(D73,A7);
    end
    
    if wavelettype.dmey
        rho_H81V81 = corr2(H81,V81);
        rho_H81D81 = corr2(H81,D81);
        rho_V81D81 = corr2(V81,D81);
        rho_H81A8 = corr2(H81,A8);
        rho_V81A8 = corr2(V81,A8);
        rho_D81A8 = corr2(D81,A8);
        
        rho_H91V91 = corr2(H91,V91);
        rho_H91D91 = corr2(H91,D91);
        rho_V91D91 = corr2(V91,D91);
        rho_H91A8 = corr2(H91,A8);
        rho_V91A8 = corr2(V91,A8);
        rho_D91A8 = corr2(D91,A8);
        
        rho_H92V92 = corr2(H92,V92);
        rho_H92D92 = corr2(H92,D92);
        rho_V92D92 = corr2(V92,D92);
        rho_H92A9 = corr2(H92,A9);
        rho_V92A9 = corr2(V92,A9);
        rho_D92A9 = corr2(D92,A9);
        
        rho_H101V101 = corr2(H101,V101);
        rho_H101D101 = corr2(H101,D101);
        rho_V101D101 = corr2(V101,D101);
        rho_H101A8 = corr2(H101,A8);
        rho_V101A8 = corr2(V101,A8);
        rho_D101A8 = corr2(D101,A8);
        
        rho_H102V102 = corr2(H102,V102);
        rho_H102D102 = corr2(H102,D102);
        rho_V102D102 = corr2(V102,D102);
        rho_H102A9 = corr2(H102,A9);
        rho_V102A9 = corr2(V102,A9);
        rho_D102A9 = corr2(D102,A9);
        
        rho_H103V103 = corr2(H103,V103);
        rho_H103D103 = corr2(H103,D103);
        rho_V103D103 = corr2(V103,D103);
        rho_H103A10 = corr2(H103,A10);
        rho_V103A10 = corr2(V103,A10);
        rho_D103A10 = corr2(D103,A10);
    end
end

% features from quality metrics
if wavelettype.haar && wavelettype.coif && wavelettype.dmey
    std_Q = [std(MAXERR) std(L2RAT) std(MSE) std(PSNR)];
    mean_Q = [mean(MAXERR) mean(L2RAT) mean(MSE) mean(PSNR)];
    d_Q = [sum(Q_h - Q_c) sum(Q_h - Q_d) sum(Q_c - Q_d)];
end
% features from energy

%     E1 = [Ea1 Eh1 Ev1 Ed1];
%     E2 = [Ea2 Eh2 Ev2 Ed2];
%     E3 = [Ea3 Eh3 Ev3 Ed3];
%     E4 = [Ea4 Eh4 Ev4 Ed4];
%     E5 = [Ea5 Eh5 Ev5 Ed5];
%     E6 = [Ea6 Eh6 Ev6 Ed6];
%     E7 = [Ea7 Eh7 Ev7 Ed7];
%     E8 = [Ea8 Eh8 Ev8 Ed8];
%     E9 = [Ea9 Eh9 Ev9 Ed9];
%     E10 = [Ea10 Eh10 Ev10 Ed10];

if wavelettype.haar && wavelettype.coif && wavelettype.dmey
    Ea = [Ea1 Ea2 Ea3 Ea4 Ea5 Ea6 Ea7 Ea8 Ea9 Ea10];
    Eh = [Eh1 Eh2 Eh3 Eh4 Eh5 Eh6 Eh7 Eh8 Eh9 Eh10];
    Ev = [Ev1 Ev2 Ev3 Ev4 Ev5 Ev6 Ev7 Ev8 Ev9 Ev10];
    Ed = [Ed1 Ed2 Ed3 Ed4 Ed5 Ed6 Ed7 Ed8 Ed9 Ed10];
end
if wavelettype.haar && wavelettype.coif
    Ea = [Ea1 Ea2 Ea3 Ea4 Ea5 Ea6 Ea7];
    Eh = [Eh1 Eh2 Eh3 Eh4 Eh5 Eh6 Eh7];
    Ev = [Ev1 Ev2 Ev3 Ev4 Ev5 Ev6 Ev7];
    Ed = [Ed1 Ed2 Ed3 Ed4 Ed5 Ed6 Ed7];
end
if wavelettype.haar && wavelettype.dmey
    Ea = [Ea1 Ea2 Ea3 Ea4 Ea8 Ea9 Ea10];
    Eh = [Eh1 Eh2 Eh3 Eh4 Eh8 Eh9 Eh10];
    Ev = [Ev1 Ev2 Ev3 Ev4 Ev8 Ev9 Ev10];
    Ed = [Ed1 Ed2 Ed3 Ed4 Ed8 Ed9 Ed10];
end
if wavelettype.coif && wavelettype.dmey
    Ea = [Ea5 Ea6 Ea7 Ea8 Ea9 Ea10];
    Eh = [Eh5 Eh6 Eh7 Eh8 Eh9 Eh10];
    Ev = [Ev5 Ev6 Ev7 Ev8 Ev9 Ev10];
    Ed = [Ed5 Ed6 Ed7 Ed8 Ed9 Ed10];
end
if wavelettype.haar
    Ea = [Ea1 Ea2 Ea3 Ea4];
    Eh = [Eh1 Eh2 Eh3 Eh4];
    Ev = [Ev1 Ev2 Ev3 Ev4];
    Ed = [Ed1 Ed2 Ed3 Ed4];
end
if wavelettype.coif
    Ea = [Ea5 Ea6 Ea7];
    Eh = [Eh5 Eh6 Eh7];
    Ev = [Ev5 Ev6 Ev7];
    Ed = [Ed5 Ed6 Ed7];
end
if wavelettype.dmey
    Ea = [Ea8 Ea9 Ea10];
    Eh = [Eh8 Eh9 Eh10];
    Ev = [Ev8 Ev9 Ev10];
    Ed = [Ed8 Ed9 Ed10];
end

std_E = [std(Ea) std(Eh) std(Ev) std(Ed)];
mean_E = [mean(Ea) mean(Eh) mean(Ev) mean(Ed)];
max_E = [max(Ea) max(Eh) max(Ev) max(Ed)];
min_E = [min(Ea) min(Eh) min(Ev) min(Ed)];

%% return feature vector

% ALL TYPES
if typeflag.global || typeflag.transform
    Out = [H1 H2 std_E mean_E max_E min_E];
    if wavelettype.haar
        Out = [Out...
            C_L1(1,100:500) S_L1(1,:) C_L2(1,100:500) S_L2(1,:)...
            C_L3(1,100:500) S_L3(1,:) C_L4(1,100:500) S_L4(1,:)...
            mean2(H11) mean2(V11) mean2(D11) mean2(H21) mean2(V21) mean2(D21)...
            mean2(H22) mean2(V22) mean2(D22) mean2(H31) mean2(V31) mean2(D31) ...
            mean2(H32) mean2(V32) mean2(D32) mean2(H33) mean2(V33) mean2(D33)...
            mean2(H41) mean2(V41) mean2(D41) mean2(H42) mean2(V42) mean2(D42)...
            mean2(H43) mean2(V43) mean2(D43) mean2(H44) mean2(V44) mean2(D44)...
            mean2(A1) mean2(A2) mean2(A3) mean2(A4) std2(A1) std2(A2) std2(A3) std2(A4) ...
            std2(H11) std2(V11) std2(D11) std2(H21) std2(V21) std2(D21)...
            std2(H22) std2(V22) std2(D22) std2(H31) std2(V31) std2(D31)...
            std2(H32) std2(V32) std2(D32) std2(H33) std2(V33) std2(D33)...
            std2(H41) std2(V41) std2(D41) std2(H42) std2(V42) std2(D42)...
            std2(H43) std2(V43) std2(D43) std2(H44) std2(V44) std2(D44)...
            X1_b X1_m X1_e X2_b X2_m X2_e...
            treenode_sum1 treenode_sum2...
            PSNR_h MSE_h MAXERR_h L2RAT_h...
            m_2_H11 m_2_V11 m_2_D11 m_2_H21 m_2_V21 m_2_D21 m_2_H22 m_2_V22...
            m_2_D22 m_2_H31 m_2_V31 m_2_D31 m_2_H32 m_2_V32 m_2_D32 m_2_H33...
            m_2_V33 m_2_D33 m_2_H41 m_2_V41 m_2_D41 m_2_H42 m_2_V42 m_2_D42...
            m_2_H43 m_2_V43 m_2_D43 m_2_H44 m_2_V44 m_2_D44...
            m_4_H11 m_4_V11 m_4_D11 m_4_H21 m_4_V21 m_4_D21 m_4_H22 m_4_V22...
            m_4_D22 m_4_H31 m_4_V31 m_4_D31 m_4_H32 m_4_V32 m_4_D32 m_4_H33...
            m_4_V33 m_4_D33 m_4_H41 m_4_V41 m_4_D41 m_4_H42 m_4_V42 m_4_D42...
            m_4_H43 m_4_V43 m_4_D43 m_4_H44 m_4_V44 m_4_D44...
            ms_2_H11 ms_2_V11 ms_2_D11 ms_2_H21 ms_2_V21 ms_2_D21 ms_2_H22...
            ms_2_V22 ms_2_D22 ms_2_H31 ms_2_V31 ms_2_D31 ms_2_H32 ms_2_V32...
            ms_2_D32 ms_2_H33 ms_2_V33 ms_2_D33 ms_2_H41 ms_2_V41 ms_2_D41...
            ms_2_H42 ms_2_V42 ms_2_D42 ms_2_H43 ms_2_V43 ms_2_D43 ms_2_H44...
            ms_2_V44 ms_2_D44...
            ms_4_H11 ms_4_V11 ms_4_D11 ms_4_H21 ms_4_V21 ms_4_D21 ms_4_H22...
            ms_4_V22 ms_4_D22 ms_4_H31 ms_4_V31 ms_4_D31 ms_4_H32 ms_4_V32...
            ms_4_D32 ms_4_H33 ms_4_V33 ms_4_D33 ms_4_H41 ms_4_V41 ms_4_D41...
            ms_4_H42 ms_4_V42 ms_4_D42 ms_4_H43 ms_4_V43 ms_4_D43 ms_4_H44...
            ms_4_V44 ms_4_D44...
            m_2_A1 m_2_A2 m_2_A3 m_2_A4 m_4_A1 m_4_A2 m_4_A3 m_4_A4...
            ms_2_A1 ms_2_A2 ms_2_A3 ms_2_A4 ms_4_A1 ms_4_A2 ms_4_A3 ms_4_A4...
            rho_H11V11 rho_H11D11 rho_V11D11 rho_H11A1 rho_V11A1 rho_D11A1...
            rho_H21V21 rho_H21D21 rho_V21D21 rho_H21A1 rho_V21A1 rho_D21A1...
            rho_H22V22 rho_H22D22 rho_V22D22 rho_H22A2 rho_V22A2 rho_D22A2...
            rho_H31V31 rho_H31D31 rho_V31D31 rho_H31A1 rho_V31A1 rho_D31A1...
            rho_H32V32 rho_H32D32 rho_V32D32 rho_H32A2 rho_V32A2 rho_D32A2...
            rho_H33V33 rho_H33D33 rho_V33D33 rho_H33A3 rho_V33A3 rho_D33A3...
            rho_H41V41 rho_H41D41 rho_V41D41 rho_H41A1 rho_V41A1 rho_D41A1...
            rho_H42V42 rho_H42D42 rho_V42D42 rho_H42A2 rho_V42A2 rho_D42A2...
            rho_H43V43 rho_H43D43 rho_V43D43 rho_H43A3 rho_V43A3 rho_D43A3...
            rho_H44V44 rho_H44D44 rho_V44D44 rho_H44A4 rho_V44A4 rho_D44A4...
            Ea1 Eh1 Ev1 Ed1 Ea2 Eh2 Ev2 Ed2 Ea3 Eh3 Ev3 Ed3 Ea4 Ev4 Eh4 Ed4]; % haar
        if wavelettype.coif
            Out = [Out...
                C_L5(1,100:500) S_L5(1,:) C_L6(1,100:500) S_L6(1,:)...
                C_L7(1,100:500) S_L7(1,:)...
                mean2(H51) mean2(V51) mean2(D51) mean2(H61) mean2(V61) mean2(D61) ...
                mean2(H62) mean2(V62) mean2(D62) mean2(H71) mean2(V71) mean2(D71) ...
                mean2(H72) mean2(V72) mean2(D72) mean2(H73) mean2(V73) mean2(D73)...
                mean2(A5) mean2(A6) mean2(A7) std2(A5) std2(A6) std2(A7)......
                std2(H51) std2(V51) std2(D51) std2(H61) std2(V61) std2(D61)...
                std2(H62) std2(V62) std2(D62) std2(H71) std2(V71) std2(D71)...
                std2(H72) std2(V72) std2(D72) std2(H73) std2(V73) std2(D73)...
                X3_b X3_m X3_e X4_b X4_m X4_e...
                treenode_sum3 treenode_sum4...
                PSNR_c MSE_c MAXERR_c L2RAT_c ...
                m_2_H51 m_2_V51 m_2_D51 m_2_H61 m_2_V61 m_2_D61 m_2_H62...
                m_2_V62 m_2_D62 m_2_H71 m_2_V71 m_2_D71 m_2_H72 m_2_V72...
                m_2_D72 m_2_H73 m_2_V73 m_2_D73...
                m_4_H51 m_4_V51 m_4_D51 m_4_H61 m_4_V61 m_4_D61 m_4_H62...
                m_4_V62 m_4_D62 m_4_H71 m_4_V71 m_4_D71 m_4_H72 m_4_V72...
                m_4_D72 m_4_H73 m_4_V73 m_4_D73...
                ms_2_H51 ms_2_V51 ms_2_D51 ms_2_H61 ms_2_V61 ms_2_D61 ms_2_H62...
                ms_2_V62 ms_2_D62 ms_2_H71 ms_2_V71 ms_2_D71 ms_2_H72 ms_2_V72...
                ms_2_D72 ms_2_H73 ms_2_V73 ms_2_D73...
                ms_4_H51 ms_4_V51 ms_4_D51 ms_4_H61 ms_4_V61 ms_4_D61 ms_4_H62...
                ms_4_V62 ms_4_D62 ms_4_H71 ms_4_V71 ms_4_D71 ms_4_H72 ms_4_V72...
                ms_4_D72 ms_4_H73 ms_4_V73 ms_4_D73...
                m_2_A5 m_2_A6 m_2_A7 m_4_A5 m_4_A6 m_4_A7...
                ms_2_A5 ms_2_A6 ms_2_A7 ms_4_A5 ms_4_A6 ms_4_A7...
                rho_H51V51 rho_H51D51 rho_V51D51 rho_H51A5 rho_V51A5 rho_D51A5...
                rho_H61V61 rho_H61D61 rho_V61D61 rho_H61A5 rho_V61A5 rho_D61A5...
                rho_H62V62 rho_H62D62 rho_V62D62 rho_H62A6 rho_V62A6 rho_D62A6...
                rho_H71V71 rho_H71D71 rho_V71D71 rho_H71A5 rho_V71A5 rho_D71A5...
                rho_H72V72 rho_H72D72 rho_V72D72 rho_H72A6 rho_V72A6 rho_D72A6...
                rho_H73V73 rho_H73D73 rho_V73D73 rho_H73A7 rho_V73A7 rho_D73A7...
                Ea5 Eh5 Ev5 Ed5 Ea6 Eh6 Ev6 Ed6 Ea7 Eh7 Ev7 Ed7]; % haar & coif
        end
        if wavelettype.dmey
            Out = [Out...
                C_L8(1,100:500) S_L8(1,:) C_L9(1,100:500) S_L9(1,:)...
                C_L10(1,100:500) S_L10(1,:) ...
                mean2(H81) mean2(V81) mean2(D81) mean2(H91) mean2(V91) mean2(D91)...
                mean2(H92) mean2(V92) mean2(D92) mean2(H101) mean2(V101) mean2(D101)...
                mean2(H102) mean2(V102) mean2(D102) mean2(H103) mean2(V103) mean2(D103)...
                mean2(A8) mean2(A9) mean2(A10)  std2(A8) std2(A9) std2(A10)...
                std2(H81) std2(V81) std2(D81) std2(H91) std2(V91) std2(D91)...
                std2(H92) std2(V92) std2(D92) std2(H101) std2(V101) std2(D101)...
                std2(H102) std2(V102) std2(D102) std2(H103) std2(V103) std2(D103)...
                X5_b X5_m X5_e X6_b X6_m X6_e...
                treenode_sum5 treenode_sum6...
                PSNR_d MSE_d MAXERR_d L2RAT_d...
                m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                m_2_H103 m_2_V103 m_2_D103...
                m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                m_4_H103 m_4_V103 m_4_D103...
                ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10...
                rho_H81V81 rho_H81D81 rho_V81D81 rho_H81A8 rho_V81A8 rho_D81A8...
                rho_H91V91 rho_H91D91 rho_V91D91 rho_H91A8 rho_V91A8 rho_D91A8...
                rho_H92V92 rho_H92D92 rho_V92D92 rho_H92A9 rho_V92A9 rho_D92A9...
                rho_H101V101 rho_H101D101 rho_V101D101 rho_H101A8 rho_V101A8...
                rho_D101A8 rho_H102V102 rho_H102D102 rho_V102D102 rho_H102A9...
                rho_V102A9 rho_D102A9 rho_H103V103 rho_H103D103 rho_V103D103...
                rho_H103A10 rho_V103A10 rho_D103A10...
                Ea8 Eh8 Ev8 Ed8 Ea9 Eh9 Ev9 Ed9 Ea10 Eh10 Ev10 Ed10]; % haar + dmey OR haar + coif + dmey
        end
        if wavelettype.coif && wavelettype.dmey
            Out = [Out std_Q mean_Q d_Q];
        end
    elseif wavelettype.coif
        Out = [Out...
            C_L5(1,100:500) S_L5(1,:) C_L6(1,100:500) S_L6(1,:)...
            C_L7(1,100:500) S_L7(1,:)...
            mean2(H51) mean2(V51) mean2(D51) mean2(H61) mean2(V61) mean2(D61) ...
            mean2(H62) mean2(V62) mean2(D62) mean2(H71) mean2(V71) mean2(D71) ...
            mean2(H72) mean2(V72) mean2(D72) mean2(H73) mean2(V73) mean2(D73)...
            mean2(A5) mean2(A6) mean2(A7) std2(A5) std2(A6) std2(A7)......
            std2(H51) std2(V51) std2(D51) std2(H61) std2(V61) std2(D61)...
            std2(H62) std2(V62) std2(D62) std2(H71) std2(V71) std2(D71)...
            std2(H72) std2(V72) std2(D72) std2(H73) std2(V73) std2(D73)...
            X3_b X3_m X3_e X4_b X4_m X4_e...
            treenode_sum3 treenode_sum4...
            PSNR_c MSE_c MAXERR_c L2RAT_c ...
            m_2_H51 m_2_V51 m_2_D51 m_2_H61 m_2_V61 m_2_D61 m_2_H62...
            m_2_V62 m_2_D62 m_2_H71 m_2_V71 m_2_D71 m_2_H72 m_2_V72...
            m_2_D72 m_2_H73 m_2_V73 m_2_D73...
            m_4_H51 m_4_V51 m_4_D51 m_4_H61 m_4_V61 m_4_D61 m_4_H62...
            m_4_V62 m_4_D62 m_4_H71 m_4_V71 m_4_D71 m_4_H72 m_4_V72...
            m_4_D72 m_4_H73 m_4_V73 m_4_D73...
            ms_2_H51 ms_2_V51 ms_2_D51 ms_2_H61 ms_2_V61 ms_2_D61 ms_2_H62...
            ms_2_V62 ms_2_D62 ms_2_H71 ms_2_V71 ms_2_D71 ms_2_H72 ms_2_V72...
            ms_2_D72 ms_2_H73 ms_2_V73 ms_2_D73...
            ms_4_H51 ms_4_V51 ms_4_D51 ms_4_H61 ms_4_V61 ms_4_D61 ms_4_H62...
            ms_4_V62 ms_4_D62 ms_4_H71 ms_4_V71 ms_4_D71 ms_4_H72 ms_4_V72...
            ms_4_D72 ms_4_H73 ms_4_V73 ms_4_D73...
            m_2_A5 m_2_A6 m_2_A7 m_4_A5 m_4_A6 m_4_A7...
            ms_2_A5 ms_2_A6 ms_2_A7 ms_4_A5 ms_4_A6 ms_4_A7...
            rho_H51V51 rho_H51D51 rho_V51D51 rho_H51A5 rho_V51A5 rho_D51A5...
            rho_H61V61 rho_H61D61 rho_V61D61 rho_H61A5 rho_V61A5 rho_D61A5...
            rho_H62V62 rho_H62D62 rho_V62D62 rho_H62A6 rho_V62A6 rho_D62A6...
            rho_H71V71 rho_H71D71 rho_V71D71 rho_H71A5 rho_V71A5 rho_D71A5...
            rho_H72V72 rho_H72D72 rho_V72D72 rho_H72A6 rho_V72A6 rho_D72A6...
            rho_H73V73 rho_H73D73 rho_V73D73 rho_H73A7 rho_V73A7 rho_D73A7...
            Ea5 Eh5 Ev5 Ed5 Ea6 Eh6 Ev6 Ed6 Ea7 Eh7 Ev7 Ed7]; % coif
        if wavelettype.dmey
            Out = [Out...
                C_L8(1,100:500) S_L8(1,:) C_L9(1,100:500) S_L9(1,:)...
                C_L10(1,100:500) S_L10(1,:) ...
                mean2(H81) mean2(V81) mean2(D81) mean2(H91) mean2(V91) mean2(D91)...
                mean2(H92) mean2(V92) mean2(D92) mean2(H101) mean2(V101) mean2(D101)...
                mean2(H102) mean2(V102) mean2(D102) mean2(H103) mean2(V103) mean2(D103)...
                mean2(A8) mean2(A9) mean2(A10)  std2(A8) std2(A9) std2(A10)...
                std2(H81) std2(V81) std2(D81) std2(H91) std2(V91) std2(D91)...
                std2(H92) std2(V92) std2(D92) std2(H101) std2(V101) std2(D101)...
                std2(H102) std2(V102) std2(D102) std2(H103) std2(V103) std2(D103)...
                X5_b X5_m X5_e X6_b X6_m X6_e...
                treenode_sum5 treenode_sum6...
                PSNR_d MSE_d MAXERR_d L2RAT_d...
                m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                m_2_H103 m_2_V103 m_2_D103...
                m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                m_4_H103 m_4_V103 m_4_D103...
                ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10...
                rho_H81V81 rho_H81D81 rho_V81D81 rho_H81A8 rho_V81A8 rho_D81A8...
                rho_H91V91 rho_H91D91 rho_V91D91 rho_H91A8 rho_V91A8 rho_D91A8...
                rho_H92V92 rho_H92D92 rho_V92D92 rho_H92A9 rho_V92A9 rho_D92A9...
                rho_H101V101 rho_H101D101 rho_V101D101 rho_H101A8 rho_V101A8...
                rho_D101A8 rho_H102V102 rho_H102D102 rho_V102D102 rho_H102A9...
                rho_V102A9 rho_D102A9 rho_H103V103 rho_H103D103 rho_V103D103...
                rho_H103A10 rho_V103A10 rho_D103A10...
                Ea8 Eh8 Ev8 Ed8 Ea9 Eh9 Ev9 Ed9 Ea10 Eh10 Ev10 Ed10]; %coif + dmey
        end
    else
        Out = [Out...
            C_L8(1,100:500) S_L8(1,:) C_L9(1,100:500) S_L9(1,:)...
            C_L10(1,100:500) S_L10(1,:) ...
            mean2(H81) mean2(V81) mean2(D81) mean2(H91) mean2(V91) mean2(D91)...
            mean2(H92) mean2(V92) mean2(D92) mean2(H101) mean2(V101) mean2(D101)...
            mean2(H102) mean2(V102) mean2(D102) mean2(H103) mean2(V103) mean2(D103)...
            mean2(A8) mean2(A9) mean2(A10)  std2(A8) std2(A9) std2(A10)...
            std2(H81) std2(V81) std2(D81) std2(H91) std2(V91) std2(D91)...
            std2(H92) std2(V92) std2(D92) std2(H101) std2(V101) std2(D101)...
            std2(H102) std2(V102) std2(D102) std2(H103) std2(V103) std2(D103)...
            X5_b X5_m X5_e X6_b X6_m X6_e...
            treenode_sum5 treenode_sum6...
            PSNR_d MSE_d MAXERR_d L2RAT_d...
            m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
            m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
            m_2_H103 m_2_V103 m_2_D103...
            m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
            m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
            m_4_H103 m_4_V103 m_4_D103...
            ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
            ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
            ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
            ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
            ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
            ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
            m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
            ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10...
            rho_H81V81 rho_H81D81 rho_V81D81 rho_H81A8 rho_V81A8 rho_D81A8...
            rho_H91V91 rho_H91D91 rho_V91D91 rho_H91A8 rho_V91A8 rho_D91A8...
            rho_H92V92 rho_H92D92 rho_V92D92 rho_H92A9 rho_V92A9 rho_D92A9...
            rho_H101V101 rho_H101D101 rho_V101D101 rho_H101A8 rho_V101A8...
            rho_D101A8 rho_H102V102 rho_H102D102 rho_V102D102 rho_H102A9...
            rho_V102A9 rho_D102A9 rho_H103V103 rho_H103D103 rho_V103D103...
            rho_H103A10 rho_V103A10 rho_D103A10...
            Ea8 Eh8 Ev8 Ed8 Ea9 Eh9 Ev9 Ed9 Ea10 Eh10 Ev10 Ed10]; % dmey
    end
    
elseif typeflag.corr
    % ONLY CORR
    if wavelettype.haar
        Out = [rho_H11V11 rho_H11D11 rho_V11D11 rho_H11A1 rho_V11A1 rho_D11A1...
            rho_H21V21 rho_H21D21 rho_V21D21 rho_H21A1 rho_V21A1 rho_D21A1...
            rho_H22V22 rho_H22D22 rho_V22D22 rho_H22A2 rho_V22A2 rho_D22A2...
            rho_H31V31 rho_H31D31 rho_V31D31 rho_H31A1 rho_V31A1 rho_D31A1...
            rho_H32V32 rho_H32D32 rho_V32D32 rho_H32A2 rho_V32A2 rho_D32A2...
            rho_H33V33 rho_H33D33 rho_V33D33 rho_H33A3 rho_V33A3 rho_D33A3...
            rho_H41V41 rho_H41D41 rho_V41D41 rho_H41A1 rho_V41A1 rho_D41A1...
            rho_H42V42 rho_H42D42 rho_V42D42 rho_H42A2 rho_V42A2 rho_D42A2...
            rho_H43V43 rho_H43D43 rho_V43D43 rho_H43A3 rho_V43A3 rho_D43A3...
            rho_H44V44 rho_H44D44 rho_V44D44 rho_H44A4 rho_V44A4 rho_D44A4]; % haar
        if wavelettype.coif
            Out = [Out...
                rho_H51V51 rho_H51D51 rho_V51D51 rho_H51A5 rho_V51A5 rho_D51A5...
                rho_H61V61 rho_H61D61 rho_V61D61 rho_H61A5 rho_V61A5 rho_D61A5...
                rho_H62V62 rho_H62D62 rho_V62D62 rho_H62A6 rho_V62A6 rho_D62A6...
                rho_H71V71 rho_H71D71 rho_V71D71 rho_H71A5 rho_V71A5 rho_D71A5...
                rho_H72V72 rho_H72D72 rho_V72D72 rho_H72A6 rho_V72A6 rho_D72A6...
                rho_H73V73 rho_H73D73 rho_V73D73 rho_H73A7 rho_V73A7 rho_D73A7]; % haar & coif
        end
        if wavelettype.dmey
            Out = [Out...
                rho_H81V81 rho_H81D81 rho_V81D81 rho_H81A8 rho_V81A8 rho_D81A8...
                rho_H91V91 rho_H91D91 rho_V91D91 rho_H91A8 rho_V91A8 rho_D91A8...
                rho_H92V92 rho_H92D92 rho_V92D92 rho_H92A9 rho_V92A9 rho_D92A9...
                rho_H101V101 rho_H101D101 rho_V101D101 rho_H101A8 rho_V101A8...
                rho_D101A8 rho_H102V102 rho_H102D102 rho_V102D102 rho_H102A9...
                rho_V102A9 rho_D102A9 rho_H103V103 rho_H103D103 rho_V103D103...
                rho_H103A10 rho_V103A10 rho_D103A10]; % haar + dmey OR haar + coif + dmey
        end
    elseif wavelettype.coif
        Out = [rho_H51V51 rho_H51D51 rho_V51D51 rho_H51A5 rho_V51A5 rho_D51A5...
            rho_H61V61 rho_H61D61 rho_V61D61 rho_H61A5 rho_V61A5 rho_D61A5...
            rho_H62V62 rho_H62D62 rho_V62D62 rho_H62A6 rho_V62A6 rho_D62A6...
            rho_H71V71 rho_H71D71 rho_V71D71 rho_H71A5 rho_V71A5 rho_D71A5...
            rho_H72V72 rho_H72D72 rho_V72D72 rho_H72A6 rho_V72A6 rho_D72A6...
            rho_H73V73 rho_H73D73 rho_V73D73 rho_H73A7 rho_V73A7 rho_D73A7]; % coif
        if wavelettype.dmey
            Out = [Out...
                rho_H81V81 rho_H81D81 rho_V81D81 rho_H81A8 rho_V81A8 rho_D81A8...
                rho_H91V91 rho_H91D91 rho_V91D91 rho_H91A8 rho_V91A8 rho_D91A8...
                rho_H92V92 rho_H92D92 rho_V92D92 rho_H92A9 rho_V92A9 rho_D92A9...
                rho_H101V101 rho_H101D101 rho_V101D101 rho_H101A8 rho_V101A8...
                rho_D101A8 rho_H102V102 rho_H102D102 rho_V102D102 rho_H102A9...
                rho_V102A9 rho_D102A9 rho_H103V103 rho_H103D103 rho_V103D103...
                rho_H103A10 rho_V103A10 rho_D103A10]; %coif + dmey
        end
    else
        Out = [rho_H81V81 rho_H81D81 rho_V81D81 rho_H81A8 rho_V81A8 rho_D81A8...
            rho_H91V91 rho_H91D91 rho_V91D91 rho_H91A8 rho_V91A8 rho_D91A8...
            rho_H92V92 rho_H92D92 rho_V92D92 rho_H92A9 rho_V92A9 rho_D92A9...
            rho_H101V101 rho_H101D101 rho_V101D101 rho_H101A8 rho_V101A8...
            rho_D101A8 rho_H102V102 rho_H102D102 rho_V102D102 rho_H102A9...
            rho_V102A9 rho_D102A9 rho_H103V103 rho_H103D103 rho_V103D103...
            rho_H103A10 rho_V103A10 rho_D103A10]; % dmey
    end
    
    % CORR + ENTROPY
    if typeflag.entropy
        Out = [Out H1 H2];
    end
    
    % CORR + MOMENTS OR CORR + MOMENTS + ENTROPY
    if typeflag.moments
        if wavelettype.haar
            Out_m = [m_2_H11 m_2_V11 m_2_D11 m_2_H21 m_2_V21 m_2_D21 m_2_H22 m_2_V22...
                m_2_D22 m_2_H31 m_2_V31 m_2_D31 m_2_H32 m_2_V32 m_2_D32 m_2_H33...
                m_2_V33 m_2_D33 m_2_H41 m_2_V41 m_2_D41 m_2_H42 m_2_V42 m_2_D42...
                m_2_H43 m_2_V43 m_2_D43 m_2_H44 m_2_V44 m_2_D44...
                m_4_H11 m_4_V11 m_4_D11 m_4_H21 m_4_V21 m_4_D21 m_4_H22 m_4_V22...
                m_4_D22 m_4_H31 m_4_V31 m_4_D31 m_4_H32 m_4_V32 m_4_D32 m_4_H33...
                m_4_V33 m_4_D33 m_4_H41 m_4_V41 m_4_D41 m_4_H42 m_4_V42 m_4_D42...
                m_4_H43 m_4_V43 m_4_D43 m_4_H44 m_4_V44 m_4_D44...
                ms_2_H11 ms_2_V11 ms_2_D11 ms_2_H21 ms_2_V21 ms_2_D21 ms_2_H22...
                ms_2_V22 ms_2_D22 ms_2_H31 ms_2_V31 ms_2_D31 ms_2_H32 ms_2_V32...
                ms_2_D32 ms_2_H33 ms_2_V33 ms_2_D33 ms_2_H41 ms_2_V41 ms_2_D41...
                ms_2_H42 ms_2_V42 ms_2_D42 ms_2_H43 ms_2_V43 ms_2_D43 ms_2_H44...
                ms_2_V44 ms_2_D44...
                ms_4_H11 ms_4_V11 ms_4_D11 ms_4_H21 ms_4_V21 ms_4_D21 ms_4_H22...
                ms_4_V22 ms_4_D22 ms_4_H31 ms_4_V31 ms_4_D31 ms_4_H32 ms_4_V32...
                ms_4_D32 ms_4_H33 ms_4_V33 ms_4_D33 ms_4_H41 ms_4_V41 ms_4_D41...
                ms_4_H42 ms_4_V42 ms_4_D42 ms_4_H43 ms_4_V43 ms_4_D43 ms_4_H44...
                ms_4_V44 ms_4_D44...
                m_2_A1 m_2_A2 m_2_A3 m_2_A4 m_4_A1 m_4_A2 m_4_A3 m_4_A4...
                ms_2_A1 ms_2_A2 ms_2_A3 ms_2_A4 ms_4_A1 ms_4_A2 ms_4_A3 ms_4_A4]; % haar
            if wavelettype.coif
                Out_m = [Out_m...
                    m_2_H51 m_2_V51 m_2_D51 m_2_H61 m_2_V61 m_2_D61 m_2_H62...
                    m_2_V62 m_2_D62 m_2_H71 m_2_V71 m_2_D71 m_2_H72 m_2_V72...
                    m_2_D72 m_2_H73 m_2_V73 m_2_D73...
                    m_4_H51 m_4_V51 m_4_D51 m_4_H61 m_4_V61 m_4_D61 m_4_H62...
                    m_4_V62 m_4_D62 m_4_H71 m_4_V71 m_4_D71 m_4_H72 m_4_V72...
                    m_4_D72 m_4_H73 m_4_V73 m_4_D73...
                    ms_2_H51 ms_2_V51 ms_2_D51 ms_2_H61 ms_2_V61 ms_2_D61 ms_2_H62...
                    ms_2_V62 ms_2_D62 ms_2_H71 ms_2_V71 ms_2_D71 ms_2_H72 ms_2_V72...
                    ms_2_D72 ms_2_H73 ms_2_V73 ms_2_D73...
                    ms_4_H51 ms_4_V51 ms_4_D51 ms_4_H61 ms_4_V61 ms_4_D61 ms_4_H62...
                    ms_4_V62 ms_4_D62 ms_4_H71 ms_4_V71 ms_4_D71 ms_4_H72 ms_4_V72...
                    ms_4_D72 ms_4_H73 ms_4_V73 ms_4_D73...
                    m_2_A5 m_2_A6 m_2_A7 m_4_A5 m_4_A6 m_4_A7...
                    ms_2_A5 ms_2_A6 ms_2_A7 ms_4_A5 ms_4_A6 ms_4_A7]; % haar & coif
            end
            if wavelettype.dmey
                Out_m = [Out_m...
                    m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                    m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                    m_2_H103 m_2_V103 m_2_D103...
                    m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                    m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                    m_4_H103 m_4_V103 m_4_D103...
                    ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                    ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                    ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                    ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                    ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                    ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                    m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                    ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10]; % haar + dmey OR haar + coif + dmey
            end
        elseif wavelettype.coif
            Out_m = [m_2_H51 m_2_V51 m_2_D51 m_2_H61 m_2_V61 m_2_D61 m_2_H62...
                m_2_V62 m_2_D62 m_2_H71 m_2_V71 m_2_D71 m_2_H72 m_2_V72...
                m_2_D72 m_2_H73 m_2_V73 m_2_D73...
                m_4_H51 m_4_V51 m_4_D51 m_4_H61 m_4_V61 m_4_D61 m_4_H62...
                m_4_V62 m_4_D62 m_4_H71 m_4_V71 m_4_D71 m_4_H72 m_4_V72...
                m_4_D72 m_4_H73 m_4_V73 m_4_D73...
                ms_2_H51 ms_2_V51 ms_2_D51 ms_2_H61 ms_2_V61 ms_2_D61 ms_2_H62...
                ms_2_V62 ms_2_D62 ms_2_H71 ms_2_V71 ms_2_D71 ms_2_H72 ms_2_V72...
                ms_2_D72 ms_2_H73 ms_2_V73 ms_2_D73...
                ms_4_H51 ms_4_V51 ms_4_D51 ms_4_H61 ms_4_V61 ms_4_D61 ms_4_H62...
                ms_4_V62 ms_4_D62 ms_4_H71 ms_4_V71 ms_4_D71 ms_4_H72 ms_4_V72...
                ms_4_D72 ms_4_H73 ms_4_V73 ms_4_D73...
                m_2_A5 m_2_A6 m_2_A7 m_4_A5 m_4_A6 m_4_A7...
                ms_2_A5 ms_2_A6 ms_2_A7 ms_4_A5 ms_4_A6 ms_4_A7]; % coif
            if wavelettype.dmey
                Out_m = [Out_m...
                    m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                    m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                    m_2_H103 m_2_V103 m_2_D103...
                    m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                    m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                    m_4_H103 m_4_V103 m_4_D103...
                    ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                    ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                    ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                    ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                    ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                    ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                    m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                    ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10]; %coif + dmey
            end
        else
            Out_m = [m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                m_2_H103 m_2_V103 m_2_D103...
                m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                m_4_H103 m_4_V103 m_4_D103...
                ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10]; % dmey
        end
        Out = [Out Out_m];
    end
    
elseif typeflag.entropy % ENTROPY
    Out = [H1 H2]; % dmey
    
    if typeflag.moments % ENTROPY + MOMENTS
        if wavelettype.haar
            Out_m = [m_2_H11 m_2_V11 m_2_D11 m_2_H21 m_2_V21 m_2_D21 m_2_H22 m_2_V22...
                m_2_D22 m_2_H31 m_2_V31 m_2_D31 m_2_H32 m_2_V32 m_2_D32 m_2_H33...
                m_2_V33 m_2_D33 m_2_H41 m_2_V41 m_2_D41 m_2_H42 m_2_V42 m_2_D42...
                m_2_H43 m_2_V43 m_2_D43 m_2_H44 m_2_V44 m_2_D44...
                m_4_H11 m_4_V11 m_4_D11 m_4_H21 m_4_V21 m_4_D21 m_4_H22 m_4_V22...
                m_4_D22 m_4_H31 m_4_V31 m_4_D31 m_4_H32 m_4_V32 m_4_D32 m_4_H33...
                m_4_V33 m_4_D33 m_4_H41 m_4_V41 m_4_D41 m_4_H42 m_4_V42 m_4_D42...
                m_4_H43 m_4_V43 m_4_D43 m_4_H44 m_4_V44 m_4_D44...
                ms_2_H11 ms_2_V11 ms_2_D11 ms_2_H21 ms_2_V21 ms_2_D21 ms_2_H22...
                ms_2_V22 ms_2_D22 ms_2_H31 ms_2_V31 ms_2_D31 ms_2_H32 ms_2_V32...
                ms_2_D32 ms_2_H33 ms_2_V33 ms_2_D33 ms_2_H41 ms_2_V41 ms_2_D41...
                ms_2_H42 ms_2_V42 ms_2_D42 ms_2_H43 ms_2_V43 ms_2_D43 ms_2_H44...
                ms_2_V44 ms_2_D44...
                ms_4_H11 ms_4_V11 ms_4_D11 ms_4_H21 ms_4_V21 ms_4_D21 ms_4_H22...
                ms_4_V22 ms_4_D22 ms_4_H31 ms_4_V31 ms_4_D31 ms_4_H32 ms_4_V32...
                ms_4_D32 ms_4_H33 ms_4_V33 ms_4_D33 ms_4_H41 ms_4_V41 ms_4_D41...
                ms_4_H42 ms_4_V42 ms_4_D42 ms_4_H43 ms_4_V43 ms_4_D43 ms_4_H44...
                ms_4_V44 ms_4_D44...
                m_2_A1 m_2_A2 m_2_A3 m_2_A4 m_4_A1 m_4_A2 m_4_A3 m_4_A4...
                ms_2_A1 ms_2_A2 ms_2_A3 ms_2_A4 ms_4_A1 ms_4_A2 ms_4_A3 ms_4_A4]; % haar
            if wavelettype.coif
                Out_m = [Out_m...
                    m_2_H51 m_2_V51 m_2_D51 m_2_H61 m_2_V61 m_2_D61 m_2_H62...
                    m_2_V62 m_2_D62 m_2_H71 m_2_V71 m_2_D71 m_2_H72 m_2_V72...
                    m_2_D72 m_2_H73 m_2_V73 m_2_D73...
                    m_4_H51 m_4_V51 m_4_D51 m_4_H61 m_4_V61 m_4_D61 m_4_H62...
                    m_4_V62 m_4_D62 m_4_H71 m_4_V71 m_4_D71 m_4_H72 m_4_V72...
                    m_4_D72 m_4_H73 m_4_V73 m_4_D73...
                    ms_2_H51 ms_2_V51 ms_2_D51 ms_2_H61 ms_2_V61 ms_2_D61 ms_2_H62...
                    ms_2_V62 ms_2_D62 ms_2_H71 ms_2_V71 ms_2_D71 ms_2_H72 ms_2_V72...
                    ms_2_D72 ms_2_H73 ms_2_V73 ms_2_D73...
                    ms_4_H51 ms_4_V51 ms_4_D51 ms_4_H61 ms_4_V61 ms_4_D61 ms_4_H62...
                    ms_4_V62 ms_4_D62 ms_4_H71 ms_4_V71 ms_4_D71 ms_4_H72 ms_4_V72...
                    ms_4_D72 ms_4_H73 ms_4_V73 ms_4_D73...
                    m_2_A5 m_2_A6 m_2_A7 m_4_A5 m_4_A6 m_4_A7...
                    ms_2_A5 ms_2_A6 ms_2_A7 ms_4_A5 ms_4_A6 ms_4_A7]; % haar & coif
            end
            if wavelettype.dmey
                Out_m = [Out_m...
                    m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                    m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                    m_2_H103 m_2_V103 m_2_D103...
                    m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                    m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                    m_4_H103 m_4_V103 m_4_D103...
                    ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                    ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                    ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                    ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                    ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                    ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                    m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                    ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10]; % haar + dmey OR haar + coif + dmey
            end
        elseif wavelettype.coif
            Out_m = [m_2_H51 m_2_V51 m_2_D51 m_2_H61 m_2_V61 m_2_D61 m_2_H62...
                m_2_V62 m_2_D62 m_2_H71 m_2_V71 m_2_D71 m_2_H72 m_2_V72...
                m_2_D72 m_2_H73 m_2_V73 m_2_D73...
                m_4_H51 m_4_V51 m_4_D51 m_4_H61 m_4_V61 m_4_D61 m_4_H62...
                m_4_V62 m_4_D62 m_4_H71 m_4_V71 m_4_D71 m_4_H72 m_4_V72...
                m_4_D72 m_4_H73 m_4_V73 m_4_D73...
                ms_2_H51 ms_2_V51 ms_2_D51 ms_2_H61 ms_2_V61 ms_2_D61 ms_2_H62...
                ms_2_V62 ms_2_D62 ms_2_H71 ms_2_V71 ms_2_D71 ms_2_H72 ms_2_V72...
                ms_2_D72 ms_2_H73 ms_2_V73 ms_2_D73...
                ms_4_H51 ms_4_V51 ms_4_D51 ms_4_H61 ms_4_V61 ms_4_D61 ms_4_H62...
                ms_4_V62 ms_4_D62 ms_4_H71 ms_4_V71 ms_4_D71 ms_4_H72 ms_4_V72...
                ms_4_D72 ms_4_H73 ms_4_V73 ms_4_D73...
                m_2_A5 m_2_A6 m_2_A7 m_4_A5 m_4_A6 m_4_A7...
                ms_2_A5 ms_2_A6 ms_2_A7 ms_4_A5 ms_4_A6 ms_4_A7]; % coif
            if wavelettype.dmey
                Out_m = [Out_m...
                    m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                    m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                    m_2_H103 m_2_V103 m_2_D103 ...
                    m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                    m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                    m_4_H103 m_4_V103 m_4_D103...
                    ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                    ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                    ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                    ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                    ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                    ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                    m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                    ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10]; %coif + dmey
            end
        else
            Out_m = [m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                m_2_H103 m_2_V103 m_2_D103...
                m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                m_4_H103 m_4_V103 m_4_D103...
                ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10]; % dmey
        end
        Out = [Out Out_m];
    end
    
else % MOMENTS
    if wavelettype.haar
        Out = [m_2_H11 m_2_V11 m_2_D11 m_2_H21 m_2_V21 m_2_D21 m_2_H22 m_2_V22...
                m_2_D22 m_2_H31 m_2_V31 m_2_D31 m_2_H32 m_2_V32 m_2_D32 m_2_H33...
                m_2_V33 m_2_D33 m_2_H41 m_2_V41 m_2_D41 m_2_H42 m_2_V42 m_2_D42...
                m_2_H43 m_2_V43 m_2_D43 m_2_H44 m_2_V44 m_2_D44...
                m_4_H11 m_4_V11 m_4_D11 m_4_H21 m_4_V21 m_4_D21 m_4_H22 m_4_V22...
                m_4_D22 m_4_H31 m_4_V31 m_4_D31 m_4_H32 m_4_V32 m_4_D32 m_4_H33...
                m_4_V33 m_4_D33 m_4_H41 m_4_V41 m_4_D41 m_4_H42 m_4_V42 m_4_D42...
                m_4_H43 m_4_V43 m_4_D43 m_4_H44 m_4_V44 m_4_D44...
                ms_2_H11 ms_2_V11 ms_2_D11 ms_2_H21 ms_2_V21 ms_2_D21 ms_2_H22...
                ms_2_V22 ms_2_D22 ms_2_H31 ms_2_V31 ms_2_D31 ms_2_H32 ms_2_V32...
                ms_2_D32 ms_2_H33 ms_2_V33 ms_2_D33 ms_2_H41 ms_2_V41 ms_2_D41...
                ms_2_H42 ms_2_V42 ms_2_D42 ms_2_H43 ms_2_V43 ms_2_D43 ms_2_H44...
                ms_2_V44 ms_2_D44...
                ms_4_H11 ms_4_V11 ms_4_D11 ms_4_H21 ms_4_V21 ms_4_D21 ms_4_H22...
                ms_4_V22 ms_4_D22 ms_4_H31 ms_4_V31 ms_4_D31 ms_4_H32 ms_4_V32...
                ms_4_D32 ms_4_H33 ms_4_V33 ms_4_D33 ms_4_H41 ms_4_V41 ms_4_D41...
                ms_4_H42 ms_4_V42 ms_4_D42 ms_4_H43 ms_4_V43 ms_4_D43 ms_4_H44...
                ms_4_V44 ms_4_D44...
                m_2_A1 m_2_A2 m_2_A3 m_2_A4 m_4_A1 m_4_A2 m_4_A3 m_4_A4...
                ms_2_A1 ms_2_A2 ms_2_A3 ms_2_A4 ms_4_A1 ms_4_A2 ms_4_A3 ms_4_A4]; % haar
        if wavelettype.coif
            Out = [Out...
                m_2_H51 m_2_V51 m_2_D51 m_2_H61 m_2_V61 m_2_D61 m_2_H62...
                m_2_V62 m_2_D62 m_2_H71 m_2_V71 m_2_D71 m_2_H72 m_2_V72...
                m_2_D72 m_2_H73 m_2_V73 m_2_D73...
                m_4_H51 m_4_V51 m_4_D51 m_4_H61 m_4_V61 m_4_D61 m_4_H62...
                m_4_V62 m_4_D62 m_4_H71 m_4_V71 m_4_D71 m_4_H72 m_4_V72...
                m_4_D72 m_4_H73 m_4_V73 m_4_D73...
                ms_2_H51 ms_2_V51 ms_2_D51 ms_2_H61 ms_2_V61 ms_2_D61 ms_2_H62...
                ms_2_V62 ms_2_D62 ms_2_H71 ms_2_V71 ms_2_D71 ms_2_H72 ms_2_V72...
                ms_2_D72 ms_2_H73 ms_2_V73 ms_2_D73...
                ms_4_H51 ms_4_V51 ms_4_D51 ms_4_H61 ms_4_V61 ms_4_D61 ms_4_H62...
                ms_4_V62 ms_4_D62 ms_4_H71 ms_4_V71 ms_4_D71 ms_4_H72 ms_4_V72...
                ms_4_D72 ms_4_H73 ms_4_V73 ms_4_D73...
                m_2_A5 m_2_A6 m_2_A7 m_4_A5 m_4_A6 m_4_A7...
                ms_2_A5 ms_2_A6 ms_2_A7 ms_4_A5 ms_4_A6 ms_4_A7]; % haar & coif
        end
        if wavelettype.dmey
            Out = [Out...
                m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                m_2_H103 m_2_V103 m_2_D103...
                m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                m_4_H103 m_4_V103 m_4_D103...
                ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10]; % haar + dmey OR haar + coif + dmey
        end
    elseif wavelettype.coif
        Out = [m_2_H51 m_2_V51 m_2_D51 m_2_H61 m_2_V61 m_2_D61 m_2_H62...
            m_2_V62 m_2_D62 m_2_H71 m_2_V71 m_2_D71 m_2_H72 m_2_V72...
            m_2_D72 m_2_H73 m_2_V73 m_2_D73...
            m_4_H51 m_4_V51 m_4_D51 m_4_H61 m_4_V61 m_4_D61 m_4_H62...
            m_4_V62 m_4_D62 m_4_H71 m_4_V71 m_4_D71 m_4_H72 m_4_V72...
            m_4_D72 m_4_H73 m_4_V73 m_4_D73...
            ms_2_H51 ms_2_V51 ms_2_D51 ms_2_H61 ms_2_V61 ms_2_D61 ms_2_H62...
            ms_2_V62 ms_2_D62 ms_2_H71 ms_2_V71 ms_2_D71 ms_2_H72 ms_2_V72...
            ms_2_D72 ms_2_H73 ms_2_V73 ms_2_D73...
            ms_4_H51 ms_4_V51 ms_4_D51 ms_4_H61 ms_4_V61 ms_4_D61 ms_4_H62...
            ms_4_V62 ms_4_D62 ms_4_H71 ms_4_V71 ms_4_D71 ms_4_H72 ms_4_V72...
            ms_4_D72 ms_4_H73 ms_4_V73 ms_4_D73...
            m_2_A5 m_2_A6 m_2_A7 m_4_A5 m_4_A6 m_4_A7...
            ms_2_A5 ms_2_A6 ms_2_A7 ms_4_A5 ms_4_A6 ms_4_A7]; % coif
        if wavelettype.dmey
            Out = [Out...
                m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
                m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
                m_2_H103 m_2_V103 m_2_D103...
                m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
                m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
                m_4_H103 m_4_V103 m_4_D103...
                ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
                ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
                ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
                ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
                ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
                ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
                m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
                ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10]; %coif + dmey
        end
    else
        Out = [m_2_H81 m_2_V81 m_2_D81 m_2_H91 m_2_V91 m_2_D91 m_2_H92 m_2_V92...
            m_2_D92 m_2_H101 m_2_V101 m_2_D101 m_2_H102 m_2_V102 m_2_D102...
            m_2_H103 m_2_V103 m_2_D103...
            m_4_H81 m_4_V81 m_4_D81 m_4_H91 m_4_V91 m_4_D91 m_4_H92 m_4_V92...
            m_4_D92 m_4_H101 m_4_V101 m_4_D101 m_4_H102 m_4_V102 m_4_D102...
            m_4_H103 m_4_V103 m_4_D103...
            ms_2_H81 ms_2_V81 ms_2_D81 ms_2_H91 ms_2_V91 ms_2_D91 ms_2_H92...
            ms_2_V92 ms_2_D92 ms_2_H101 ms_2_V101 ms_2_D101 ms_2_H102...
            ms_2_V102 ms_2_D102 ms_2_H103 ms_2_V103 ms_2_D103...
            ms_4_H81 ms_4_V81 ms_4_D81 ms_4_H91 ms_4_V91 ms_4_D91 ms_4_H92...
            ms_4_V92 ms_4_D92 ms_4_H101 ms_4_V101 ms_4_D101 ms_4_H102...
            ms_4_V102 ms_4_D102 ms_4_H103 ms_4_V103 ms_4_D103...
            m_2_A8 m_2_A9 m_2_A10 m_4_A8 m_4_A9 m_4_A10...
            ms_2_A8 ms_2_A9 ms_2_A10 ms_4_A8 ms_4_A9 ms_4_A10]; % dmey
    end
end






end
